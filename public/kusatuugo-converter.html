<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>„Åè„Åï„Å§„Éº„ÅîÂ§âÊèõ</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=BIZ+UDGothic:wght@400;700&family=BIZ+UDMincho:wght@400;700&family=Intel+One+Mono:wght@400;700&family=Noto+Color+Emoji&family=Noto+Sans:wght@400;700&family=Noto+Serif+Hentaigana:wght@400;700&family=Noto+Serif:wght@400;700&display=swap" rel="stylesheet">
<style>
body {
  font-family: 'Noto Serif', 'BIZ UDMincho', 'Noto Serif Hentaigana', serif;
  margin: 0;
  padding: 0;
  box-sizing: border-box;
  height: 100vh;
  display: flex;
}

textarea {
  width: 50%;
  height: 100vh;
  font-family: 'Noto Serif', 'BIZ UDMincho', 'Noto Serif Hentaigana', serif;
  font-size: 16px;
  padding: 20px;
  box-sizing: border-box;
  border: none;
  resize: none;
  outline: none;
}

#input {
  border-right: 1px solid #ccc;
}
</style>
</head>
<body>
<textarea id="input" placeholder="ÂÖ•Âäõ"></textarea>
<textarea id="output" placeholder="Âá∫Âäõ" readonly></textarea>

<script>
const conversionRules = [
	/* Ë¶ã„Åà„Çã */
	// todo: „Åä„Åô„Åè„Å≤„ÇÅ„Çä„Çì
	// todo: ÊøÅÁÇπ / ÂçäÊøÅÁÇπ
	['5', 'õÉ™'],
	//[, 'õÅ¥'],
	['m', 'õÅ©'],
	['m', 'õÅ™'],
	['Œ±', 'õÇî'],
	['‚òè', 'õÉ∂'],
	['„ÅÇ', 'õÄì'],
	['„ÅÇ', 'õÄ¥'],
	['„ÅÇ', 'õÅç'],
	['„ÅÇ', 'õÅó'],
	['„ÅÇ', 'õÑÑ'],
	['„ÅÑ', 'õÄÜ'],
	['„ÅÑ', 'õÇÖ'],
	['„ÅÜ', 'õÄö'],
	//['„ÅÜ', 'õÉè'],
	['„Åà', 'õÄÖ'],
	['„Åà', 'õÄí'],
	['„Åà', 'õÄ¨'],
	['„Åà', 'õÅÑ'],
	['„Åà', 'õÇ¶'],
	['„Åà', 'õÇØ'],
	['„Åà', 'õÑù'],
	['„Åà', 'õÑû'],
	['„Åã', 'õÄò'],
	['„Åç', 'õÄ∑'],
	['„Åç', 'õÑÄ'],
	['„Åë', 'õÄ∂'],
	['Ê±Å', 'õÄ∂'],
	['Êäû', 'õÇº'],
	['„Åë', 'õÅÉ'],
	['„Åï', 'õÄ∏'],
	['„Åï', 'õÅí'],
	['„Åï', 'õÅ†'],
	['„Åï', 'õÅ≥'],
	['„Å¶„Åè', 'õÅ≥'],
	['„Åó', 'õÅÖ'],
	['„Åù', 'õÄç'],
	['„Åù', 'õÅµ'],
	['„Åù', 'õÇ£'],
	['„Åù', 'õÑÉ'],
	['„Åü', 'õÄï'],
	['„Å°', 'õÅ¶'],
	['„Å§', 'õÉª'],
	['„Å¶', 'õÅ≤'],
	['„Å™', 'õÄÑ'],
	['„Å™', 'õÄπ'],
	['„Å´', 'õÅë'],
	['„Å´', 'õÅò'],
	['„Å´', 'õÇâ'],
	['„Å¨', '„Çê'],
	['„Å¨', 'õÄå'],
	['„Å¨', 'õÅÅ'],
	['„Å¨', 'õÇê'],
	['„Å¨', 'õÇ±'],
	['„Å≠', 'õÄÅ'],
	['„Å≠', 'õÄâ'],
	['„Å≠', 'õÄ±'],
	['„Å≠', 'õÅÅ'],
	['„Å≠', 'õÇ™'],
	['„Å≠', 'õÉ¶'],
	['„ÅÆ', 'õÄô'],
	['„ÅÆ', 'õÇô'],
	['„ÅØ', 'õÄ∫'],
	['„ÅØ', 'õÅ´'],
	['„ÅØ', 'õÇ°'],
	['„Åµ', 'õÄü'],
	['„Åµ', 'õÇÅ'],
	['„Åµ', 'õÇì'],
	['„Åµ', 'õÉº'],
	['„Å∏', 'õÇπ'],
	['„Åª', 'õÇö'],
	['„Åª', 'õÇª'],
	['„Åæ', 'õÑñ'],
	['„Åø', 'õÇú'],
	['„Åø', 'õÉå'],
	['„ÇÄ', 'õÇ¶'],
	['„ÇÄ', 'õÉê'],
	['„ÇÇ', 'õÉò'],
	['„ÇÑ', 'õÉû'],
	['„ÇÜ', 'õÉù'],
	['„ÇÜ', 'õÉ§'],
	['„ÇÜ', 'õÉ•'],
	['„Çà', 'õÄ¶'],
	['„Çà', 'õÇå'],
	//['„Çà', 'õÇî'],
	['„Çâ', 'õÅ¶'],
	['„Çâ', 'õÉØ'],
	['„Çã', 'õÅÜ'],
	['„Çã', 'õÇÇ'],
	['„Çã', 'õÇé'],
	['„Çã', 'õÉï'],
	['„Çã', 'õÉñ'],
	['„Çã', 'õÉ™'],
	['„Çã', 'õÉπ'],
	['„Çå', 'õÉø'],
	['„Çç', 'õÅö'],
	['„Çç', 'õÇç'],
	['„Çç', 'õÇπ'],
	['„Çç', 'õÉç'],
	['„Åø', 'õÉç'],
	['„Çç', 'õÉ∞'],
	['„Çç', 'õÑÇ'],
	['„Çè', 'õÅó'],
	['„Çè', 'õÉ≤'],
	['„Çè', 'õÑä'],
	['„Çê', 'õÅÅ'],
	['„Çë', 'õÇë'],
	['„Çë', 'õÉã'],
	['„Çí', 'õÄ∑'],
	['„Çí', 'õÄø'],
	['„Çí', 'õÅí'],
	['„Çí', 'õÑõ'],
	['„Çí', 'õÑú'],
	['„Å®', 'õÑú'],
	['„Ç≠', 'õÅì'],
	['„Éç', 'õÄÄ'],
	['„Éè', 'õÇû'],
	['„Éí', 'õÄº'],
	['„Éõ', 'õÅó'],
	['„Éõ', 'õÅΩ'],
	['„Éõ', 'õÇã'],
	['„Éü', 'õÉâ'],
	['„É¢', 'õÉô'],
	['„É©', 'õÄÄ'],
	['„É©', 'õÑó'],
	['‰πÉ', 'õÉÇ'],
	['‰πû', 'õÉ´'],
	['‰∫å', 'õÇà'],
	['„Åì', 'õÇà'],
	['ÂÑ™', 'õÄñ'],
	['ÂÖâ', 'õÄ©'],
	['ÂÖ´', 'õÇû'],
	['ÂåÅ', 'õÇá'],
	['Âêç', 'õÅø'],
	['Âñú', 'õÅã'],
	['Âõõ', 'õÅá'],
	['Âúü', 'õÅ∑'],
	['Âú∞', 'õÅ£'],
	['Â†Ç', 'õÅû'],
	['Â§©', 'õÅ±'],
	['Â≠ê', 'õÅ¢'],
	['Â∑±', 'õÑå'],
	['Âπ≥', 'õÉÄ'],
	['Ê≠ª', 'õÇñ'],
	['ÊØç', 'õÉ•'],
	['ÊØé', 'õÅü'],
	['ÁÉπ', 'õÅà'],
	['Áìú', 'õÅä'],
	['Áü≥', 'õÇ∞'],
	['Á©∂', 'õÇä'],
	['Á∑ë', 'õÄ§'],
	['Èõë', 'õÇÜ'],
	['Èõ®', 'õÅó'],
	['ÔºÜ', 'õÉö'],
	//['„Çà', 'õÑñ'],
	['üïé', 'õÅî'],
	['„Çã„Çì', '„Çë'],
	['„Å¨„Å¶', 'õÄè'],
	//['ÔΩ≤„ÇÄ', 'õÄó'],
	//['ÔΩ∂Ôæú', 'õÄò'],
	['„Åµ„Çã', 'õÄ†'],
	['„Åë„Å°', 'õÄæ'],
	['„Åà„Å°', 'õÅâ'],
	['ÂÖâ„Çã', 'õÅå'],
	['„Åæ„Å¶', 'õÅè'],
	['„Åï„Å¶', 'õÅè'],
	['„ÇÑ„Çã', 'õÅô'],
	//['„ÅÜ„Çã', 'õÅù'],
	['„Åô„Çã', 'õÅß'],
	['„Åª„Åù', 'õÅ≠'],
	['„Åà„Çà', 'õÅ∏'],
	//['„Å≠„Éü', 'õÅ∫'],
	['„Çã„ÅÆ', 'õÇÇ'],
	//['„Çç„Çä', 'õÇç'],
	//['„Çã„Çä', 'õÇé'],
	['„Å¨„Ç´', 'õÇè'],
	['„Å¨„Çì', 'õÇë'],
	//['„Çã„Å°', 'õÇõ'],
	['„ÅØ„ÇÅ', 'õÇ†'],
	['„Çå„Çç', 'õÇ≠'],
	['„ÇÜ„Åæ', 'õÉÑ'],
	//['„Å§„Çì', 'õÉé'],
	['„Åà„Çã', 'õÉ†'],
	['„Çã„ÇÄ', 'õÉü'],
	['„ÅÜ„Çì', 'õÉÆ'],
	['„ÅÜ„Å´', 'õÉÆ'],
	['„ÅÜ„Çâ', 'õÉØ'],
	//['„ÅØ„Åµ', 'õÉ∏'],
	['„Åø„Çä', 'õÄ≤'],
	//['„Çç„Çç', 'õÄ≥'],
	['„ÇÑ„Åµ', 'õÄ¢'],
	//['„Åü„Çã„Å®', 'õÄñ'],
	['„Åã„Çä„Çã', 'õÄ°'],
	//['‰∏É„Ç´„É™', 'õÄõ'],
	['„Åª„Çã„Çì', 'õÅê'],
	['„Å°„Çä„Çã', 'õÅ§'],
	//['„Ç§„Åæ„Çã', 'õÅ∞'],
	//['„Ç§„ÇΩ„Éõ', 'õÇ∫'],
	['Êó•', 'õÇª'],
	['Êó¨', 'õÉÜ'],
	['„Åö', 'õÉë'],
	//['„Åè', 'õÄ¨'],
	['‚ôø', 'õÇí'],
	['„ÇÄ', 'õÑã'],
	//['„Åô', 'õÑã'],
	['„Åõ', 'õÅî'],
	//['„Çì', 'õÑû'],

	/* https://codh.rois.ac.jp/char-shape/hentaigana/ */
	['ÂÆâ', 'õÄÇ'],
	['ÊÑõ', 'õÄÉ'],
	['Èòø', 'õÄÑ'],
	['ÊÉ°', 'õÄÖ'],
	['‰ª•', 'õÄÜ'],
	['‰ºä', 'õÄá'],
	['ÊÑè', 'õÄà'],
	['Áßª', 'õÄâ'],
	['ÂÆá', 'õÄä'],
	['ÂÆá', 'õÄã'],
	['ÊÜÇ', 'õÄå'],
	['Êúâ', 'õÄç'],
	['Èõ≤', 'õÄé'],
	['Ê±ü', 'õÄÅ'],
	['Áõà', 'õÄè'],
	['Á∏Å', 'õÄê'],
	['Ë°£', 'õÄë'],
	['Ë°£', 'õÄí'],
	['Ë¶Å', 'õÄì'],
	['Êñº', 'õÄî'],
	['Êñº', 'õÄï'],
	['Èö±', 'õÄñ'],
	['‰Ω≥', 'õÄó'],
	['Âä†', 'õÄò'],
	['ÂèØ', 'õÄô'],
	['ÂèØ', 'õÄö'],
	['Âòâ', 'õÄõ'],
	['Êàë', 'õÄú'],
	['Ê≠ü', 'õÄù'],
	['Ë≥Ä', 'õÄû'],
	['Èñë', 'õÄü'],
	['È¶ô', 'õÄ†'],
	['Èßï', 'õÄ°'],
	['ÂÆ∂', 'õÄ¢'],
	['Âñú', 'õÄ£'],
	['Âπæ', 'õÄ§'],
	['Âπæ', 'õÄ•'],
	['ÊîØ', 'õÄ¶'],
	['Êú®', 'õÄß'],
	['Á•à', 'õÄ®'],
	['Ë≤¥', 'õÄ©'],
	['Ëµ∑', 'õÄ™'],
	['Êúü', 'õÄª'],
	['‰πÖ', 'õÄ´'],
	['‰πÖ', 'õÄ¨'],
	['‰πù', 'õÄ≠'],
	['‰æõ', 'õÄÆ'],
	['ÂÄ∂', 'õÄØ'],
	['ÂÖ∑', 'õÄ∞'],
	['Ê±Ç', 'õÄ±'],
	['‰ªã', 'õÄ≤'],
	['‰ªã', 'õÄ≥'],
	['Â∏å', 'õÄ¥'],
	['Ê∞£', 'õÄµ'],
	['Ë®à', 'õÄ∂'],
	['ÈÅ£', 'õÄ∑'],
	['ÂÆ∂', 'õÄ¢'],
	['Âè§', 'õÄ∏'],
	['ÊïÖ', 'õÄπ'],
	['Ë®±', 'õÄ∫'],
	['Êúü', 'õÄª'],
	['Â≠ê', 'õÇò'],
	['‰πç', 'õÄº'],
	['‰Ωê', 'õÄΩ'],
	['‰Ωê', 'õÄæ'],
	['Â∑¶', 'õÄø'],
	['Â∑Æ', 'õÅÄ'],
	['Êï£', 'õÅÅ'],
	['Êñú', 'õÅÇ'],
	['Ê≤ô', 'õÅÉ'],
	['‰πã', 'õÅÑ'],
	['‰πã', 'õÅÖ'],
	['‰∫ã', 'õÅÜ'],
	['Âõõ', 'õÅá'],
	['Âøó', 'õÅà'],
	['Êñ∞', 'õÅâ'],
	['Âèó', 'õÅä'],
	['Â£Ω', 'õÅã'],
	['Êï∏', 'õÅå'],
	['Êï∏', 'õÅç'],
	['Êò•', 'õÅé'],
	['Êò•', 'õÅè'],
	['È†à', 'õÅê'],
	['È†à', 'õÅë'],
	['‰∏ñ', 'õÅí'],
	['‰∏ñ', 'õÅì'],
	['‰∏ñ', 'õÅî'],
	['Âã¢', 'õÅï'],
	['ËÅ≤', 'õÅñ'],
	['ÊâÄ', 'õÅó'],
	['ÊâÄ', 'õÅò'],
	['Êõæ', 'õÅô'],
	['Êõæ', 'õÅö'],
	['Ê•ö', 'õÅõ'],
	['Ëòá', 'õÅú'],
	['Ëôï', 'õÅù'],
	['Â†Ç', 'õÅû'],
	['Â§ö', 'õÅü'],
	['Â§ö', 'õÅ†'],
	['Áï∂', 'õÅ°'],
	['ÂçÉ', 'õÅ¢'],
	['Âú∞', 'õÅ£'],
	['Êô∫', 'õÅ§'],
	['Áü•', 'õÅ•'],
	['Áü•', 'õÅ¶'],
	['Ëá¥', 'õÅß'],
	['ÈÅ≤', 'õÅ®'],
	['Â∑ù', 'õÅ©'],
	['Â∑ù', 'õÅ™'],
	['Ê¥•', 'õÅ´'],
	['ÈÉΩ', 'õÅ¨'],
	['Âæí', 'õÅ≠'],
	['‰∫≠', 'õÅÆ'],
	['‰Ωé', 'õÅØ'],
	['ÂÇ≥', 'õÅ∞'],
	['Â§©', 'õÅ±'],
	['Â§©', 'õÅ≤'],
	['Â§©', 'õÅ≥'],
	['Â∏ù', 'õÅ¥'],
	['Âºñ', 'õÅµ'],
	['ËΩâ', 'õÅ∂'],
	['ËÄå', 'õÇé'],
	['Âúü', 'õÅ∑'],
	['Â∫¶', 'õÅ∏'],
	['Êù±', 'õÅπ'],
	['Áôª', 'õÅ∫'],
	['Áôª', 'õÅª'],
	['Á†•', 'õÅº'],
	['Âæí', 'õÅ≠'],
	['Á≠â', 'õÅΩ'],
	['Âçó', 'õÅæ'],
	['Âêç', 'õÅø'],
	['Â•à', 'õÇÄ'],
	['Â•à', 'õÇÅ'],
	['Â•à', 'õÇÇ'],
	['Ëèú', 'õÇÉ'],
	['ÈÇ£', 'õÇÑ'],
	['ÈÇ£', 'õÇÖ'],
	['Èõ£', 'õÇÜ'],
	['‰∏π', 'õÇá'],
	['‰∫å', 'õÇà'],
	['‰ªÅ', 'õÇâ'],
	['ÂÖí', 'õÇä'],
	['Áàæ', 'õÇã'],
	['Áàæ', 'õÇå'],
	['ËÄ≥', 'õÇç'],
	['ËÄå', 'õÇé'],
	['Âä™', 'õÇè'],
	['Â•¥', 'õÇê'],
	['ÊÄí', 'õÇë'],
	['Âπ¥', 'õÇí'],
	['Âπ¥', 'õÇì'],
	['Âπ¥', 'õÇî'],
	['Ê†π', 'õÇï'],
	['ÁÜ±', 'õÇñ'],
	['Á¶∞', 'õÇó'],
	['Â≠ê', 'õÇò'],
	['‰πÉ', 'õÇô'],
	['ÊøÉ', 'õÇö'],
	['ËÉΩ', 'õÇõ'],
	['ËÉΩ', 'õÇú'],
	['Ëæ≤', 'õÇù'],
	['ÂÖ´', 'õÇû'],
	['Âçä', 'õÇü'],
	['Â©Ü', 'õÇ†'],
	['Ê≥¢', 'õÇ°'],
	['Áõ§', 'õÇ¢'],
	['Áõ§', 'õÇ£'],
	['Á†¥', 'õÇ§'],
	['ËÄÖ', 'õÇ•'],
	['ËÄÖ', 'õÇ¶'],
	['Ëëâ', 'õÇß'],
	['È†ó', 'õÇ®'],
	['ÊÇ≤', 'õÇ©'],
	['Êó•', 'õÇ™'],
	['ÊØî', 'õÇ´'],
	['ÈÅø', 'õÇ¨'],
	['Èùû', 'õÇ≠'],
	['È£õ', 'õÇÆ'],
	['È£õ', 'õÇØ'],
	['‰∏ç', 'õÇ∞'],
	['Â©¶', 'õÇ±'],
	['Â∏É', 'õÇ≤'],
	['ÂÄç', 'õÇ≥'],
	['Âºä', 'õÇ¥'],
	['Âºä', 'õÇµ'],
	['ÈÅç', 'õÇ∂'],
	['ÈÇä', 'õÇ∑'],
	['ÈÇä', 'õÇ∏'],
	['ÈÉ®', 'õÇπ'],
	['‰øù', 'õÇ∫'],
	['‰øù', 'õÇª'],
	['Â†±', 'õÇº'],
	['Â•â', 'õÇΩ'],
	['ÂØ∂', 'õÇæ'],
	['Êú¨', 'õÇø'],
	['Êú¨', 'õÉÄ'],
	['Ë±ê', 'õÉÅ'],
	['‰∏á', 'õÉÇ'],
	['Êú´', 'õÉÉ'],
	['Êú´', 'õÉÑ'],
	['Êªø', 'õÉÖ'],
	['Êªø', 'õÉÜ'],
	['Ëê¨', 'õÉá'],
	['È∫ª', 'õÉà'],
	['È¶¨', 'õÉñ'],
	['‰∏â', 'õÉâ'],
	['ÂæÆ', 'õÉä'],
	['Áæé', 'õÉã'],
	['Áæé', 'õÉå'],
	['Áæé', 'õÉç'],
	['Ë¶ã', 'õÉé'],
	['Ë∫´', 'õÉè'],
	['Ê≠¶', 'õÉê'],
	['ÁÑ°', 'õÉë'],
	['Áâü', 'õÉí'],
	['Ëàû', 'õÉì'],
	['Êó†', 'õÑù'],
	['Êó†', 'õÑû'],
	['ÂÖç', 'õÉî'],
	['Èù¢', 'õÉï'],
	['È¶¨', 'õÉñ'],
	['ÊØç', 'õÉó'],
	['ÊØõ', 'õÉò'],
	['ÊØõ', 'õÉô'],
	['ÊØõ', 'õÉö'],
	['ËåÇ', 'õÉõ'],
	['Ë£≥', 'õÉú'],
	['Êó†', 'õÑù'],
	['Êó†', 'õÑû'],
	['‰πü', 'õÉù'],
	['‰πü', 'õÉû'],
	['Â±ã', 'õÉü'],
	['ËÄ∂', 'õÉ†'],
	['ËÄ∂', 'õÉ°'],
	['Â§ú', 'õÉ¢'],
	['Ê∏∏', 'õÉ£'],
	['Áî±', 'õÉ§'],
	['Áî±', 'õÉ•'],
	['ÈÅä', 'õÉ¶'],
	['‰ª£', 'õÉß'],
	['‰Ωô', 'õÉ®'],
	['Ëàá', 'õÉ©'],
	['Ëàá', 'õÉ™'],
	['Ëàá', 'õÉ´'],
	['È§ò', 'õÉ¨'],
	['Â§ú', 'õÉ¢'],
	['ÁæÖ', 'õÉ≠'],
	['ËâØ', 'õÉÆ'],
	['ËâØ', 'õÉØ'],
	['ËâØ', 'õÉ∞'],
	['Á≠â', 'õÅΩ'],
	['Âà©', 'õÉ±'],
	['Âà©', 'õÉ≤'],
	['Êùé', 'õÉ≥'],
	['Ê¢®', 'õÉ¥'],
	['ÁêÜ', 'õÉµ'],
	['Èáå', 'õÉ∂'],
	['Èõ¢', 'õÉ∑'],
	['ÊµÅ', 'õÉ∏'],
	['Áïô', 'õÉπ'],
	['Áïô', 'õÉ∫'],
	['Áïô', 'õÉª'],
	['Á¥Ø', 'õÉº'],
	['È°û', 'õÉΩ'],
	['Á¶Æ', 'õÉæ'],
	['Á¶Æ', 'õÉø'],
	['ÈÄ£', 'õÑÄ'],
	['È∫ó', 'õÑÅ'],
	['ÂëÇ', 'õÑÇ'],
	['ÂëÇ', 'õÑÉ'],
	['Â©Å', 'õÑÑ'],
	['Ê®ì', 'õÑÖ'],
	['Ë∑Ø', 'õÑÜ'],
	['Èú≤', 'õÑá'],
	['ÂÄ≠', 'õÑà'],
	['Âíå', 'õÑâ'],
	['Âíå', 'õÑä'],
	['Áéã', 'õÑã'],
	['Áéã', 'õÑå'],
	['‰∫ï', 'õÑç'],
	['‰∫ï', 'õÑé'],
	['Â±Ö', 'õÑè'],
	['Áà≤', 'õÑê'],
	['ÈÅ∫', 'õÑë'],
	['ÊÉ†', 'õÑí'],
	['Ë°û', 'õÑì'],
	['Ë°û', 'õÑî'],
	['Ë°û', 'õÑï'],
	['‰πé', 'õÑñ'],
	['‰πé', 'õÑó'],
	['Â∞æ', 'õÑò'],
	['Á∑í', 'õÑô'],
	['Ë∂ä', 'õÑö'],
	['ÈÅ†', 'õÑõ'],
	['ÈÅ†', 'õÑú'],
	['ÊÉ°', 'õÄÖ'],
	['Êó†', 'õÑù'],
	['Êó†', 'õÑû'],
];

const input = document.getElementById('input');
const output = document.getElementById('output');

input.addEventListener('input', () => {
  output.value = convert(input.value);
});

function convert(text) {
  const rulesByLength = {};
  for (const [from, to] of conversionRules) {
    if (!rulesByLength[from]) {
      rulesByLength[from] = [];
    }
    rulesByLength[from].push(to);
  }
  
  const sortedKeys = Object.keys(rulesByLength).sort((a, b) => b.length - a.length);
  let result = '';
  let i = 0;
  
  while (i < text.length) {
    let matched = false;
    
    for (const key of sortedKeys) {
      if (text.substr(i, key.length) === key) {
        const candidates = rulesByLength[key];
        result += candidates[Math.floor(Math.random() * candidates.length)];
        i += key.length;
        matched = true;
        break;
      }
    }
    
    if (!matched) {
      result += text[i];
      i++;
    }
  }
  
  return result;
}
</script>
</body>
</html>
